# ржЕржбрж┐ржУ ржбрж╛ржЯрж╛ ржкрзНрж░ржХрзНрж░рж┐рзЯрж╛ржХрж░ржг

ЁЯдЧ ржбрзЗржЯрж╛рж╕рзЗржЯрзЗрж░ рж╕рж╛ржерзЗ ржПржХржЯрж┐ ржбрзЗржЯрж╛рж╕рзЗржЯ рж▓рзЛржб ржХрж░рж╛ ржоржЬрж╛рж░ ржЕрж░рзНржзрзЗржХред ржЖржкржирж┐ ржпржжрж┐ ржПржЯрж┐ ржПржХржЯрж┐ ржоржбрзЗрж▓ train ржХрж░рж╛рж░ ржЬржирзНржп ржмрж╛ inference ржЪрж╛рж▓рж╛ржирзЛрж░ ржЬржирзНржп ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛рж░
ржкрж░рж┐ржХрж▓рзНржкржирж╛ ржХрж░рзЗржи, ржЖржкржирж╛ржХрзЗ ржкрзНрж░ржержорзЗ ржбрзЗржЯрж╛ ржкрзНрж░рж╛ржХ-ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ ржХрж░рждрзЗ рж╣ржмрзЗред рж╕рж╛ржзрж╛рж░ржгржнрж╛ржмрзЗ, ржПржЯрж┐ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржкржжржХрзНрж╖рзЗржкржЧрзБрж▓рж┐ржХрзЗ ржЕржирзНрждрж░рзНржнрзБржХрзНржд ржХрж░ржмрзЗ:

* ржЕржбрж┐ржУ ржбрзЗржЯрж╛ resample ржХрж░рж╛
* ржбрзЗржЯрж╛рж╕рзЗржЯ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рж╛
* ржоржбрзЗрж▓рзЗрж░ ржкрзНрж░рждрзНржпрж╛рж╢рж┐ржд ржЗржиржкрзБржЯрзЗ ржЕржбрж┐ржУ ржбрзЗржЯрж╛ рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рж╛

## ржЕржбрж┐ржУ ржбрж╛ржЯрж╛ ржХрзЗ Resample ржХрж░рж╛

`load_dataset` ржлрж╛ржВрж╢ржиржЯрж┐ ржпрзЗржЗ sampling rate ржПрж░ рж╕рж╛ржерзЗ ржЕржбрж┐ржУ ржЙржжрж╛рж╣рж░ржгржЧрзБрж▓рж┐ upload ржХрж░рж╛ рж╣рзЯрзЗржЫрж┐рж▓ рж╕рзЗржЗ sampling rate ржП рж╕рзЗржЗ ржЕржбрж┐ржУ ржЙржжрж╛рж╣рж░ржгржЧрзБрж▓рж┐ржХрзЗ ржбрж╛ржЙржирж▓рзЛржб ржХрж░рзЗред ржПржЯрж┐ рж╕рж░рзНржмржжрж╛
ржЖржкржирж┐ ржпрзЗ ржоржбрзЗрж▓ржХрзЗ train ржХрж░рж╛рж░ ржкрж░рж┐ржХрж▓рзНржкржирж╛ ржХрж░ржЫрзЗржи ржмрж╛ inference ржЬржирзНржп ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржЫрзЗржи рждрж╛рж░ ржжрзНржмрж╛рж░рж╛  ржкрзНрж░рждрзНржпрж╛рж╢рж┐ржд sampling rate ржПрж░ рж╕ржорж╛ржи ржирж╛ржУ рж╣рждрзЗ ржкрж╛рж░рзЗ ред ржпржжрж┐ ржПрж░ ржоржзрзНржпрзЗ ржЕржорж┐рж▓ ржерж╛ржХрзЗ
рждрж╛рж╣рж▓рзЗ ржЖржкржирж╛ржХрзЗ ржЕржбрж┐ржУ рждрж╛ржХрзЗ resample ржХрж░рждрзЗ рж╣ржмрзЗ ред

ржЙржкрж▓ржмрзНржз ржкрзНрж░рж╛ржХ-ржкрзНрж░рж╢рж┐ржХрзНрж╖рж┐ржд ржоржбрзЗрж▓ржЧрзБрж▓рж┐рж░ ржмрзЗрж╢рж┐рж░ржнрж╛ржЧржЗ рззрзм kHz ржПрж░ ржиржорзБржирж╛ рж╣рж╛рж░рзЗ ржЕржбрж┐ржУ ржбрзЗржЯрж╛рж╕рзЗржЯрзЗ ржкрзВрж░рзНржмржкрзНрж░рж╢рж┐ржХрзНрж╖рж┐ржд рж╣ржпрж╝рзЗржЫрзЗред
ржпржЦржи ржЖржорж░рж╛ MINDS-14 ржбрзЗржЯрж╛рж╕рзЗржЯ ржЕржирзНржмрзЗрж╖ржг ржХрж░рзЗржЫрж┐, ржЖржкржирж┐ рж╣ржпрж╝рждрзЛ рж▓ржХрзНрж╖рзНржп ржХрж░рзЗржЫрзЗржи ржпрзЗ ржПржЯрж┐ рзо kHz ржП sample ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ, ржпрж╛рж░ ржорж╛ржирзЗ ржЖржорж╛ржжрзЗрж░ resample ржХрж░рждрзЗ рж╣ржмрзЗред

ржПржЯрж┐ ржХрж░рждрзЗ, ЁЯдЧ ржбрзЗржЯрж╛рж╕рзЗржЯрзЗрж░ `cast_column` ржкржжрзНржзрждрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред ржПржЗ ржЕржкрж╛рж░рзЗрж╢ржи ржЬрж╛ржпрж╝ржЧрж╛ржпрж╝ ржЕржбрж┐ржУ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рзЗ ржирж╛, ржмрж░ржВ рж╕ржВржХрзЗржд
ржбрзЗржЯрж╛рж╕рзЗржЯржЧрзБрж▓рж┐ рж▓рзЛржб ржХрж░рж╛рж░ рж╕ржоржпрж╝ ржлрзНрж▓рж╛ржЗрждрзЗ ржЕржбрж┐ржУ ржЙржжрж╛рж╣рж░ржгржЧрзБрж▓рж┐ ржкрзБржирж░рж╛ржпрж╝ ржиржорзБржирж╛ ржХрж░рждрзЗред ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд ржХрзЛржб рж╕рзНржпрж╛ржорзНржкрж▓рж┐ржВ рж╕рзЗржЯ ржХрж░ржмрзЗ
рззрзм kHz ржкрж░рзНржпржирзНржд рж╣рж╛рж░:

```py
from datasets import Audio

minds = minds.cast_column("audio", Audio(sampling_rate=16_000))
```

MINDS-14 ржбрзЗржЯрж╛рж╕рзЗржЯрзЗ ржкрзНрж░ржержо ржЕржбрж┐ржУ ржЙржжрж╛рж╣рж░ржгржЯрж┐ ржкрзБржирж░рж╛ржпрж╝ рж▓рзЛржб ржХрж░рзБржи ржПржмржВ ржПржЯрж┐ ржкржЫржирзНржжрж╕ржЗ `sampling rate`-ржП ржкрзБржирж░рж╛ржпрж╝ ржиржорзБржирж╛ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ ржХрж┐ржирж╛ рждрж╛ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи:

```py
minds[0]
```

**ржЖржЙржЯржкрзБржЯ:**
```out
{
    "path": "/root/.cache/huggingface/datasets/downloads/extracted/f14948e0e84be638dd7943ac36518a4cf3324e8b7aa331c5ab11541518e9368c/en-AU~PAY_BILL/response_4.wav",
    "audio": {
        "path": "/root/.cache/huggingface/datasets/downloads/extracted/f14948e0e84be638dd7943ac36518a4cf3324e8b7aa331c5ab11541518e9368c/en-AU~PAY_BILL/response_4.wav",
        "array": array(
            [
                2.0634243e-05,
                1.9437837e-04,
                2.2419340e-04,
                ...,
                9.3852862e-04,
                1.1302452e-03,
                7.1531429e-04,
            ],
            dtype=float32,
        ),
        "sampling_rate": 16000,
    },
    "transcription": "I would like to pay my electricity bill using my card can you please assist",
    "intent_class": 13,
}
```

ржЖржкржирж┐ рж▓ржХрзНрж╖рзНржп ржХрж░рждрзЗ ржкрж╛рж░рзЗржи ржпрзЗ ржЕрзНржпрж╛рж░рзЗрж░ ржорж╛ржиржЧрзБрж▓рж┐ржУ ржПржЦржи ржнрж┐ржирзНржиред ржПрж░ ржХрж╛рж░ржг рж╣рж▓ ржЖржорж░рж╛ ржПржЦржи ржПрж░ ржЬржирзНржп amplitude ржорж╛ржиржЧрзБрж▓рж┐рж░ ржжрзНржмрж┐ржЧрзБржг рж╕ржВржЦрзНржпрж╛ ржкрзЗржпрж╝рзЗржЫрж┐
ржкрзНрж░рждрж┐ржЯрж┐ ржпрзЗ ржЖржорж░рж╛ ржЖржЧрзЗ ржЫрж┐рж▓.

<Tip>
ЁЯТб Resampling рж╕ржорзНржкрж░рзНржХрзЗ ржХрж┐ржЫрзБ рждржерзНржп: ржпржжрж┐ ржПржХржЯрж┐ ржЕржбрж┐ржУ рж╕рж┐ржЧржирзНржпрж╛рж▓ рзо kHz ржП ржиржорзБржирж╛ ржирзЗржУржпрж╝рж╛ рж╣ржпрж╝, ржпрж╛рждрзЗ ржкрзНрж░рждрж┐ рж╕рзЗржХрзЗржирзНржбрзЗ рзорзжрзжрзж ржиржорзБржирж╛ рж░рж┐ржбрж┐ржВ рж╣ржпрж╝, ржЖржорж░рж╛ ржЬрж╛ржирж┐ ржпрзЗ ржЕржбрж┐ржУрждрзЗ
рзк kHz ржПрж░ ржмрзЗрж╢рж┐ ржлрзНрж░рж┐ржХрзЛржпрж╝рзЗржирзНрж╕рж┐ ржирзЗржЗ, ржПржЯрж┐ Nyquist sampling theorem ржжрзНржмрж╛рж░рж╛ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рж╛ рж╣ржпрж╝ред ржПржЗ ржХрж╛рж░ржгрзЗ, ржЖржорж░рж╛ ржирж┐рж╢рзНржЪрж┐ржд рж╣рждрзЗ ржкрж╛рж░рж┐ ржпрзЗ рж╕рзНржпрж╛ржорзНржкрж▓рж┐ржВ ржкржпрж╝рзЗржирзНржЯржЧрзБрж▓рж┐рж░ ржоржзрзНржпрзЗ
рж╕рж░рзНржмржжрж╛ ржорзВрж▓ ржЕржмрж┐ржЪрзНржЫрж┐ржирзНржи рж╕ржВржХрзЗржд ржерж╛ржХрзЗ ржпрж╛ ржПржХржЯрж┐ ржорж╕рзГржг ржмржХрзНрж░рж░рзЗржЦрж╛ рждрзИрж░рж┐ ржХрж░рзЗред upsampling ржХрж░рж╛рж░ ржорж╛ржирзЗ рждржЦржи, ржЕрждрж┐рж░рж┐ржХрзНржд ржиржорзБржирж╛рж░ ржорж╛ржи ржПржЗ ржмржХрзНрж░рж░рзЗржЦрж╛ ржЖржирзБржорж╛ржи ржХрж░рзЗ ржЧржгржирж╛ ржХрж░рж╛ред
ржПржЗ ржорж╛ржиржЧрзБрж▓рж┐ ржЖржЧрзЗ ржерзЗржХрзЗ ржЙржкрж╕рзНржерж┐ржд ржпржорзБржирж╛рж░ ржорж╛ржи ржПрж░ рж╕рж╛рж╣рж╛ржпрзНржпрзЗ ржЧржгржирж╛ ржХрж░рж╛ рж╣рзЯред  downsampling ржПрж░ ржЬржирзНржпрзЗ ржЖржорж░рж╛ ржкрзНрж░ржержорзЗ ржпрзЗржХрзЛржирзЛ ржлрзНрж░рж┐ржХрзЛржпрж╝рзЗржирзНрж╕рж┐ ржлрж┐рж▓рзНржЯрж╛рж░ ржЖржЙржЯ ржХрж░рж┐ ржпрж╛
Nyquist рж╕рзАржорж╛рж░ ржЪрзЗржпрж╝рзЗ ржмрзЗрж╢рж┐, рждрж╛рж░ржкрж░ ржирждрзБржи ржиржорзБржирж╛ ржЧржгржирж╛ ржХрж░рж┐ред ржЕржирзНржп ржХржерж╛ржпрж╝, ржЖржкржирж┐ ржкрзНрж░рждрж┐ ржжрзНржмрж┐рждрзАрзЯ ржиржорзБржирж╛ржХрзЗ ржЫрзБржБржбрж╝рзЗ ржлрзЗрж▓рж╛рж░ ржорж╛ржзрзНржпржорзЗ рзиx ржлрзНржпрж╛ржХрзНржЯрж░ ржП downsample ржХрж░рждрзЗ
ржкрж╛рж░ржмрзЗржи ржирж╛ - ржПржЯрж┐ рж╕рж┐ржЧржирзНржпрж╛рж▓рзЗ ржмрж┐ржХрзГрждрж┐ рждрзИрж░рж┐ ржХрж░ржмрзЗред resampling рж╕ржарж┐ржХржнрж╛ржмрзЗ ржХрж░рж╛ ржХржарж┐ржи ржПржмржВ ржнрж╛рж▓-ржкрж░рзАржХрзНрж╖рж┐ржд рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ ржпрзЗржоржи librosa ржмрж╛ ЁЯдЧ datasets ржПрж░ ржЙржкрж░ ржЫрзЗржбрж╝рзЗ ржжрзЗржУржпрж╝рж╛ржЗ ржнрж╛рж▓рзЛред
</Tip>

## ржбрзЗржЯрж╛рж╕рзЗржЯ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рж╛

ржХрж┐ржЫрзБ ржорж╛ржиржжржгрзНржбрзЗрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ ржбрзЗржЯрж╛ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗред рж╕рж╛ржзрж╛рж░ржг ржХрзНрж╖рзЗрждрзНрж░рзЗ ржПржХржЯрж┐ ржЕржбрж┐ржУрж░ рж╕ржоржпрж╝ржХрж╛рж▓ рж╕рзАржорж┐рждред
ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржПржХржЯрж┐ ржоржбрзЗрж▓ training ржПрж░ рж╕ржорзЯ ржЖржорж░рж╛ рзирзж рж╕рзЗржХрзЗржирзНржбрж╕ ржПрж░ ржмрзЗрж╢рж┐ ржпрзЗржХрзЛржи ржЙржжрж╛рж╣рж░ржг ржлрж┐рж▓рзНржЯрж╛рж░ ржЖржЙржЯ ржХрж░рждрзЗ ржЪрж╛ржЗ ржЖржЙржЯ ржЕржл ржорзЗржорж░рж┐рж░ рждрзНрж░рзБржЯрж┐ржЧрзБрж▓рж┐ рж░рзЛржз ржХрж░рждрзЗред

ржЖржорж░рж╛ ЁЯдЧ ржбрзЗржЯрж╛рж╕рзЗржЯрзЗрж░ `filter` ржкржжрзНржзрждрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржПржмржВ ржлрж┐рж▓рзНржЯрж╛рж░рж┐ржВ рж▓ржЬрж┐ржХ рж╕рж╣ ржПржХржЯрж┐ ржлрж╛ржВрж╢ржи ржкрж╛рж╕ ржХрж░рзЗ ржПржЯрж┐ ржХрж░рждрзЗ ржкрж╛рж░рж┐ред ржПржХржЯрж┐ ржлрж╛ржВрж╢ржи рж▓рж┐ржЦрзЗ рж╢рзБрж░рзБ ржХрж░рж╛ ржпрж╛ржХ ржпрж╛
ржирж┐рж░рзНржжрзЗрж╢ ржХрж░рзЗ ржХрзЛржи ржЙржжрж╛рж╣рж░ржг рж░рж╛ржЦрждрзЗ рж╣ржмрзЗ ржПржмржВ ржХрзЛржиржЯрж┐ ржмрж╛рждрж┐рж▓ ржХрж░рждрзЗ рж╣ржмрзЗред ржПржЗ ржлрж╛ржВрж╢ржи, `is_audio_length_in_range`, ржПржХржЯрж┐ ржиржорзБржирж╛ рзирзж рж╕рзЗржХрзЗржирзНржбрзЗрж░ ржЪрзЗржпрж╝рзЗ ржЫрзЛржЯ рж╣рж▓рзЗ
`True` ржПржмржВ рзирзж рж╕рзЗржХрзЗржирзНржбрзЗрж░ ржПрж░ ржмрзЗрж╢рж┐ рж╣рж▓рзЗ `False` ржкрзНрж░ржжрж╛ржи ржХрж░рзЗред

```py
MAX_DURATION_IN_SECONDS = 20.0


def is_audio_length_in_range(input_length):
    return input_length < MAX_DURATION_IN_SECONDS
```

ржлрж┐рж▓рзНржЯрж╛рж░рж┐ржВ ржлрж╛ржВрж╢ржиржЯрж┐ ржбрзЗржЯрж╛рж╕рзЗржЯрзЗрж░ ржХрж▓рж╛ржорзЗ ржкрзНрж░ржпрж╝рзЛржЧ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗ рждржмрзЗ ржЖржорж╛ржжрзЗрж░ ржХрж╛ржЫрзЗ ржПрждрзЗ ржЕржбрж┐ржУ ржЯрзНрж░рзНржпрж╛ржХрзЗрж░ рж╕ржоржпрж╝ржХрж╛рж▓ рж╕рж╣ ржПржХржЯрж┐ ржХрж▓рж╛ржо ржирзЗржЗ
ржбрзЗржЯрж╛рж╕рзЗржЯ ржпрж╛ржЗрж╣рзЛржХ, ржЖржорж░рж╛ ржПржХржЯрж┐ рждрзИрж░рж┐ ржХрж░рждрзЗ ржкрж╛рж░рж┐, рж╕рзЗржЗ ржХрж▓рж╛ржорзЗрж░ ржорж╛ржиржЧрзБрж▓рж┐рж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рж┐ ржПржмржВ рждрж╛рж░ржкрж░рзЗ ржПржЯрж┐ рж╕рж░рж┐ржпрж╝рзЗ ржлрзЗрж▓рждрзЗ ржкрж╛рж░рж┐ред

```py
# use librosa to get example's duration from the audio file
new_column = [librosa.get_duration(filename=x) for x in minds["path"]]
minds = minds.add_column("duration", new_column)

# use ЁЯдЧ Datasets' `filter` method to apply the filtering function
minds = minds.filter(is_audio_length_in_range, input_columns=["duration"])

# remove the temporary helper column
minds = minds.remove_columns(["duration"])
minds
```

**ржЖржЙржЯржкрзБржЯ:**
```out
Dataset({features: ["path", "audio", "transcription", "intent_class"], num_rows: 624})
```

ржЖржорж░рж╛ ржпрж╛ржЪрж╛ржЗ ржХрж░рждрзЗ ржкрж╛рж░рж┐ ржпрзЗ ржбрзЗржЯрж╛рж╕рзЗржЯ рзмрзлрзк ржЯрж┐ ржЙржжрж╛рж╣рж░ржг ржерзЗржХрзЗ рзмрзирзк ржП ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред

## ржЕржбрж┐ржУ ржбрзЗржЯрж╛ ржкрзНрж░рж╛ржХ-ржкрзНрж░рж╕рзЗрж╕рж┐ржВ

ржЕржбрж┐ржУ ржбрзЗржЯрж╛рж╕рзЗржЯржЧрзБрж▓рж┐рж░ рж╕рж╛ржерзЗ ржХрж╛ржЬ ржХрж░рж╛рж░ рж╕ржмржЪрзЗржпрж╝рзЗ ржЪрзНржпрж╛рж▓рзЗржЮрзНржЬрж┐ржВ ржжрж┐ржХржЧрзБрж▓рж┐рж░ ржоржзрзНржпрзЗ ржПржХржЯрж┐ рж╣рж▓ ржоржбрзЗрж▓рзЗрж░ ржЬржирзНржп рж╕ржарж┐ржХ ржмрж┐ржирзНржпрж╛рж╕рзЗ ржбрзЗржЯрж╛ ржкрзНрж░рж╕рзНрждрзБржд ржХрж░рж╛редржЖржкржирж┐ ржпрзЗржоржи ржжрзЗржЦрзЗржЫрзЗржи, ржХрж╛ржБржЪрж╛ ржЕржбрж┐ржУ
ржбрзЗржЯрж╛ ржиржорзБржирж╛ ржорж╛ржиржЧрзБрж▓рж┐рж░ ржПржХржЯрж┐ ржЕрзНржпрж╛рж░рзЗ рж╣рж┐рж╕рж╛ржмрзЗ ржЖрж╕рзЗред ржпрж╛ржЗрж╣рзЛржХ, pre-trained ржоржбрзЗрж▓ржЧрзБрж▓рж┐ ржЗржиржкрзБржЯ ржлрж┐ржЪрж╛рж░рж╕ ржЖрж╢рж╛ ржХрж░рзЗред ржПржЗ ржЗржиржкрзБржЯ ржлрж┐ржЪрж╛рж░рж╕ ржоржбрзЗрж▓ ржерзЗржХрзЗ ржоржбрзЗрж▓ ржП ржЖрж▓рж╛ржжрж╛ рж╣рзЯред
ржнрж╛рж▓ ржЦржмрж░ рж╣рж▓, ржкрзНрж░рждрж┐ржЯрж┐ рж╕ржорж░рзНржерж┐ржд ржЕржбрж┐ржУ ржоржбрзЗрж▓рзЗрж░ ржЬржирзНржп, ЁЯдЧ transformers ржПржХржЯрж┐ ржлрзАржЪрж╛рж░ ржПржХрзНрж╕ржЯрзНрж░рзНржпрж╛ржХрзНржЯрж░ ржХрзНрж▓рж╛рж╕ ржЕржлрж╛рж░ ржХрж░рзЗ ржпрж╛ ржХрж╛ржБржЪрж╛ ржЕржбрж┐ржУ ржбрзЗржЯрж╛ ржерзЗржХрзЗ ржоржбрзЗрж▓рзЗрж░ ржЖрж╢рж╛ ржХрж░рж╛
ржЗржиржкрзБржЯ ржлрж┐ржЪрж╛рж░рж╕ ржП рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗред

рждрж╛рж╣рж▓рзЗ ржПржХржЯрж┐ ржлрзАржЪрж╛рж░ ржПржХрзНрж╕ржЯрзНрж░рж╛ржХрзНржЯрж░, ржХрж╛ржБржЪрж╛ ржЕржбрж┐ржУ ржбрзЗржЯрж╛ ржжрж┐ржпрж╝рзЗ ржХрзА ржХрж░рзЗ? ржЖрж╕рзБржи ржлрзАржЪрж╛рж░ ржПржХрзНрж╕ржЯрзНрж░рж╛ржХрзНржЯрж░ ржХрж┐ржЫрзБ рж╕рж╛ржзрж╛рж░ржг ржлрзАржЪрж╛рж░ ржирж┐рж╖рзНржХрж╛рж╢ржи рж░рзВржкрж╛ржирзНрждрж░ ржмрзБржЭрждрзЗ [Whisper](https://cdn.openai.com/papers/whisper.pdf)
ржПрж░ ржжрж┐ржХрзЗ ржПржХржмрж╛рж░ ржиржЬрж░ ржжрзЗржУржпрж╝рж╛ ржпрж╛ржХред whisper рж╣рж▓рзЛ ржПржХржЯрж┐ ржкрж░рзЗ-trained ржоржбрзЗрж▓ ржпрж╛ automatic speech recognition (ASR) ржПрж░ ржЬржирзНржпрзЗ 2022 рж╕рж╛рж▓рзЗрж░ рж╕рзЗржкрзНржЯрзЗржорзНржмрж░рзЗ
Alec Radford et al ржжрзНржмрж╛рж░рж╛ ржкрзНрж░ржХрж╛рж╢рж┐ржд OpenAI ржерзЗржХрзЗред

ржкрзНрж░ржержоржд, whisper ржлрж┐ржЪрж╛рж░ ржПржХрзНрж╕ржЯрзНрж░рзНржпрж╛ржХрзНржЯрж░ ржкрзНржпрж╛ржб/ржЫрзЗржБржЯрзЗ ржЕржбрж┐ржУ ржЙржжрж╛рж╣рж░ржгрзЗрж░ ржПржХржЯрж┐ ржмрзНржпрж╛ржЪ рждрзИрж░рзА ржХрж░рзЗ ржпрж╛рждрзЗ рж╕ржм
ржЙржжрж╛рж╣рж░ржгрзЗрж░ ржЗржиржкрзБржЯ ржжрзИрж░рзНржШрзНржп 30 рж╕рзЗржХрзЗржирзНржб рж╣рзЯред ржПрж░ ржЪрзЗржпрж╝рзЗ ржЫрзЛржЯ ржЙржжрж╛рж╣рж░ржгржЧрзБрж▓рж┐ржХрзЗ 30 ржПрж░ рж╢рзЗрж╖рзЗ рж╢рзВржирзНржп ржпрзБржХрзНржд ржХрж░рзЗ ржкрзНржпрж╛ржб ржХрж░рж╛ рж╣ржпрж╝
ржХрзНрж░ржо (ржПржХржЯрж┐ ржЕржбрж┐ржУ рж╕рж┐ржЧржирзНржпрж╛рж▓рзЗ рж╢рзВржирзНржп ржХрзЛржи рж╕ржВржХрзЗржд ржмрж╛ ржирзАрж░ржмрждрж╛рж░ рж╕рж╛ржерзЗ рж╕ржЩрзНржЧрждрж┐ржкрзВрж░рзНржг ржиржпрж╝)ред рзйрзж ржПрж░ ржЪрзЗржпрж╝рзЗ ржжрзАрж░рзНржШ ржЙржжрж╛рж╣рж░ржгржЧрзБрж▓рж┐ржХрзЗ рзйрзж ржП ржЫрзЗржБржЯрзЗ ржлрзЗрж▓рж╛ рж╣ржпрж╝рзЗржЫрзЗрз╖
ржпрзЗрж╣рзЗрждрзБ ржмрзНржпрж╛ржЪрзЗрж░ рж╕ржорж╕рзНржд ржЙржкрж╛ржжрж╛ржи ржЗржиржкрзБржЯ рж╕рзНржкрзЗрж╕рзЗ рж╕рж░рзНржмрж╛ржзрж┐ржХ ржжрзИрж░рзНржШрзНржпрзЗ ржкрзНржпрж╛ржбрзЗржб/ржЫрзЗржБржЯрзЗ ржЖржЫрзЗ, рждрж╛ржЗ attention mask ржПрж░ ржкрзНрж░ржпрж╝рзЛржЬржи ржирзЗржЗред
ржЕржирзНржпрж╛ржирзНржп ржЕржбрж┐ржУ ржоржбрзЗрж▓рзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ attention mask ржкрзНрж░ржпрж╝рзЛржЬржи ржпрж╛ ржирж┐рж░рзНржжрзЗрж╢ ржХрж░рзЗ
ржпрзЗржЦрж╛ржирзЗ ржЕржбрж┐ржУржЧрзБрж▓рж┐ ржкрзНржпрж╛ржб ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ ржПржмржВ self-attention mechanism ржП рж╕рзЗржЧрзБрж▓рзЛ ржЙржкрзЗржХрзНрж╖рж╛ ржХрж░рзЗ рж╣рзЯред

whisper ржлрж┐ржЪрж╛рж░ ржПржХрзНрж╕ржЯрзНрж░рж╛ржХрзНржЯрж░ ржпрзЗ ржжрзНржмрж┐рждрзАржпрж╝ ржЕржкрж╛рж░рзЗрж╢ржиржЯрж┐ ржХрж░рзЗ рждрж╛ рж╣рж▓ ржкрзНржпрж╛ржбрзЗржб ржЕржбрж┐ржУ ржЕрзНржпрж╛рж░рзЗржЧрзБрж▓рж┐ржХрзЗ log-mel spectrogram ржП рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рж╛ред
ржЖржкржирж╛рж░ ржоржирзЗ ржЖржЫрзЗ, ржПржЗ spectrogram ржЧрзБрж▓рж┐ ржмрж░рзНржгржирж╛ ржХрж░рзЗ ржпрзЗ ржХрзАржнрж╛ржмрзЗ ржПржХржЯрж┐ рж╕ржВржХрзЗрждрзЗрж░ ржлрзНрж░рж┐ржХрзЛржпрж╝рзЗржирзНрж╕рж┐ рж╕ржоржпрж╝рзЗрж░ рж╕рж╛ржерзЗ ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржпрж╝, ржПржмржВ ржлрзНрж░рж┐ржХрзЛржпрж╝рзЗржирзНрж╕рж┐ ржПржмржВ amplitude ржЧрзБрж▓рзЛржХрзЗ
ржорж╛ржирзБрж╖рзЗрж░ рж╢рзНрж░ржмржгрж╢ржХрзНрждрж┐рж░ ржЖрж░ржУ ржкрзНрж░рждрж┐ржирж┐ржзрж┐ ржХрж░рзЗ рждрзБрж▓рждрзЗ mel рж╕рзНржХрзЗрж▓рзЗ ржкрзНрж░ржХрж╛рж╢ ржХрж░рж╛ рж╣ржпрж╝ ржПржмржВ ржкрж░рзЗ рждрж╛ржХрзЗ ржбрзЗрж╕рж┐ржмрзЗрж▓рзЗ ржкрж░рж┐ржорж╛ржк ржХрж░рж╛ рж╣ржпрж╝ред


ржПржЗ рж╕ржорж╕рзНржд рж░рзВржкрж╛ржирзНрждрж░ржЧрзБрж▓рж┐ ржХрзЛржбрзЗрж░ ржХржпрж╝рзЗржХржЯрж┐ рж▓рж╛ржЗржирзЗрж░ рж╕рж╛ржерзЗ ржЖржкржирж╛рж░ ржХрж╛ржБржЪрж╛ ржЕржбрж┐ржУ ржбрзЗржЯрж╛рждрзЗ ржкрзНрж░ржпрж╝рзЛржЧ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗред ржЪрж▓рзБржи whisper ржлрзАржЪрж╛рж░ ржПржХрзНрж╕ржЯрзНрж░рж╛ржХрзНржЯрж░ ржХрзЗ ржЪрзЗржХрзНржкржЗржгрзНржЯ ржерзЗржХрзЗ рж▓рзЛржб ржХрж░рж╛ ржпрж╛ржХ:

```py
from transformers import WhisperFeatureExtractor

feature_extractor = WhisperFeatureExtractor.from_pretrained("openai/whisper-small")
```

ржПрж░ ржкрж░рзЗ, ржЖржкржирж┐ ржПржХржЯрж┐ ржлрж╛ржВрж╢ржи рж▓рж┐ржЦрждрзЗ ржкрж╛рж░рзЗржи ржПржХржЯрж┐ ржПржХржХ ржЕржбрж┐ржУ ржЙржжрж╛рж╣рж░ржгржХрзЗ ржкрзНрж░рж┐-ржкрзНрж░рж╕рзЗрж╕ ржХрж░рж╛рж░ ржЬржирзНржп ржПржЯрж┐ржХрзЗ `feature_extractor` ржПрж░ ржорж╛ржзрзНржпржорзЗ ржкрж╛рж╕ ржХрж░рзЗред

```py
def prepare_dataset(example):
    audio = example["audio"]
    features = feature_extractor(
        audio["array"], sampling_rate=audio["sampling_rate"], padding=True
    )
    return features
```

ржЖржорж░рж╛ ЁЯдЧ ржбрзЗржЯрж╛рж╕рзЗржЯрзЗрж░ map ржкржжрзНржзрждрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЖржорж╛ржжрзЗрж░ рж╕ржорж╕рзНржд ржкрзНрж░рж╢рж┐ржХрзНрж╖ржг ржЙржжрж╛рж╣рж░ржгржЧрзБрж▓рж┐рждрзЗ ржбрзЗржЯрж╛ ржкрзНрж░рж╕рзНрждрзБрждрж┐рж░ ржлрж╛ржВрж╢ржи ржкрзНрж░ржпрж╝рзЛржЧ ржХрж░рждрзЗ ржкрж╛рж░рж┐:

```py
minds = minds.map(prepare_dataset)
minds
```

**ржЖржЙржЯржкрзБржЯ:**
```out
Dataset(
    {
        features: ["path", "audio", "transcription", "intent_class", "input_features"],
        num_rows: 624,
    }
)
```

ржпрждржЯрж╛ рж╕рж╣ржЬ, ржЖржорж╛ржжрзЗрж░ ржХрж╛ржЫрзЗ ржПржЦржи ржбрзЗржЯрж╛рж╕рзЗржЯрзЗ `input_features` рж╣рж┐рж╕рзЗржмрзЗ log-mel spectrogram ржЖржЫрзЗред

ржЖрж╕рзБржи ржПржЯрж┐ржХрзЗ 'minds' ржбрзЗржЯрж╛рж╕рзЗржЯрзЗрж░ ржПржХржЯрж┐ ржЙржжрж╛рж╣рж░ржгрзЗрж░ ржЬржирзНржп ржХрж▓рзНржкржирж╛ ржХрж░рж┐:

```py
import numpy as np

example = minds[0]
input_features = example["input_features"]

plt.figure().set_figwidth(12)
librosa.display.specshow(
    np.asarray(input_features[0]),
    x_axis="time",
    y_axis="mel",
    sr=feature_extractor.sampling_rate,
    hop_length=feature_extractor.hop_length,
)
plt.colorbar()
```

<div class="flex justify-center">
    <img src="https://huggingface.co/datasets/huggingface-course/audio-course-images/resolve/main/log_mel_whisper.png" alt="Log mel spectrogram plot">
</div>

ржПржЦржи ржЖржкржирж┐ ржкрзНрж░рж┐-ржкрзНрж░рж╕рзЗрж╕рж┐ржВржпрж╝рзЗрж░ ржкрж░рзЗ whisper ржоржбрзЗрж▓рзЗрж░ ржЕржбрж┐ржУ ржЗржиржкрзБржЯржЯрж┐ ржХрзЗржоржи ржжрзЗржЦрж╛ржпрж╝ рждрж╛ ржжрзЗржЦрждрзЗ ржкрж╛рж░рзЗржиред

ржоржбрзЗрж▓рзЗрж░ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп ржПржХрзНрж╕ржЯрзНрж░рзНржпрж╛ржХрзНржЯрж░ ржХрзНрж▓рж╛рж╕ржЯрж┐ ржоржбрзЗрж▓ржЯрж┐ ржкрзНрж░рждрзНржпрж╛рж╢рж╛ ржХрж░рзЗ ржПржоржи ржлрж░рзНржорзНржпрж╛ржЯрзЗ ржХрж╛ржБржЪрж╛ ржЕржбрж┐ржУ ржбрзЗржЯрж╛ рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рж╛рж░ ржпрждрзНржи ржирзЗржпрж╝ред ржпрж╛рж╣рзЛржХ,
ржЕржбрж┐ржУ ржЬржбрж╝рж┐ржд ржЕржирзЗржХ ржХрж╛ржЬ ржорж╛рж▓рзНржЯрж┐ржорзЛржбрж╛рж▓, ржпрзЗржоржи ржХржирзНржа рж╕ржирж╛ржирзНрждржХрж░ржг. ржПржЗ ржзрж░ржирзЗрж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ ЁЯдЧ ржЯрзНрж░рж╛ржирзНрж╕ржлрж░ржорж╛рж░ржЧрзБрж▓рж┐ржУ ржоржбрзЗрж▓-ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржЕржлрж╛рж░ ржХрж░рзЗ
ржЯрзЗржХрзНрж╕ржЯ ржЗржиржкрзБржЯ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ ржХрж░рж╛рж░ ржЬржирзНржп tokenizers. ржЯрзЛржХрзЗржирж╛ржЗржЬрж╛рж░ржЧрзБрж▓рж┐рждрзЗ ржЧржнрзАрж░ржнрж╛ржмрзЗ ржбрзБржм ржжрзЗржУржпрж╝рж╛рж░ ржЬржирзНржп, ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ ржЖржорж╛ржжрзЗрж░ [NLP ржХрзЛрж░рзНрж╕](https://huggingface.co/course/chapter2/4) ржжрзЗржЦрзБржиред

ржЖржкржирж┐ Whisper ржПржмржВ ржЕржирзНржпрж╛ржирзНржп ржорж╛рж▓рзНржЯрж┐ржоржбрж╛рж▓ ржоржбрзЗрж▓рзЗрж░ ржЬржирзНржп ржЖрж▓рж╛ржжрж╛ржнрж╛ржмрзЗ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп ржПржХрзНрж╕ржЯрзНрж░рзНржпрж╛ржХрзНржЯрж░ ржПржмржВ ржЯрзЛржХрзЗржирж╛ржЗржЬрж╛рж░ рж▓рзЛржб ржХрж░рждрзЗ ржкрж╛рж░рзЗржи, ржЕржержмрж╛ ржЖржкржирж┐ ржкрзНрж░рж╕рзЗрж╕рж░ ржХрзНрж▓рж╛рж╕ ржПрж░ ржорж╛ржжрзНржзржорзЗ ржЙржнржпрж╝ рж▓рзЛржб ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред
ржЬрж┐ржирж┐рж╕ржЧрзБрж▓рж┐ржХрзЗ ржЖрж░ржУ рж╕рж╣ржЬ ржХрж░рждрзЗ, ржПржХржЯрж┐ ржоржбрзЗрж▓рзЗрж░ ржлрж┐ржЪрж╛рж░ ржПржХрзНрж╕ржЯрзНрж░рзНржпрж╛ржХрзНржЯрж░ ржПржмржВ ржкрзНрж░рж╕рзЗрж╕рж░ рж▓рзЛржб ржХрж░рждрзЗ `AutoProcessor` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи
ржЪрзЗржХржкржпрж╝рзЗржирзНржЯ, ржПржЗ ржоржд:

```py
from transformers import AutoProcessor

processor = AutoProcessor.from_pretrained("openai/whisper-small")
```

ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ ржорзМрж▓рж┐ржХ рждржерзНржп ржкрзНрж░рж╕рзНрждрзБрждрж┐рж░ ржзрж╛ржкржЧрзБрж▓рж┐ ржЪрж┐рждрзНрж░рж┐ржд ржХрж░рзЗржЫрж┐ред ржЕржмрж╢рзНржпржЗ, ржХрж╛рж╕рзНржЯржо ржбрзЗржЯрж╛ ржЖрж░ржУ ржЬржЯрж┐рж▓ ржкрзНрж░рж┐ржкрзНрж░рж╕рзЗрж╕рж┐ржВржпрж╝рзЗрж░ ржкрзНрж░ржпрж╝рзЛржЬржи рж╣рждрзЗ ржкрж╛рж░рзЗред
ржПржЗ ржХрзНрж╖рзЗрждрзНрж░рзЗ, ржЖржкржирж┐ ржпрзЗржХрзЛржи ржзрж░ржгрзЗрж░ ржХрж╛рж╕рзНржЯржо ржбрзЗржЯрж╛ ржЯрзНрж░рж╛ржирзНрж╕ржлрж░ржорзЗрж╢ржи ржХрж░рж╛рж░ ржЬржирзНржп `prepare_dataset` ржлрж╛ржВрж╢ржиржЯрж┐ ржкрзНрж░рж╕рж╛рж░рж┐ржд ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред ЁЯдЧ ржЖржкржирж┐ ржпржжрж┐ ржПржЯрж┐ ржПржХржЯрж┐ ржкрж╛ржЗржержи
ржлрж╛ржВрж╢ржи рж╣рж┐рж╕рж╛ржмрзЗ рж▓рж┐ржЦрждрзЗ ржкрж╛рж░рзЗржи, рждрж╛рж╣рж▓рзЗ ржЖржкржирж┐ ржПржЯрж┐ ржЖржкржирж╛рж░ ржбрзЗржЯрж╛рж╕рзЗржЯрзЗ ржкрзНрж░ржпрж╝рзЛржЧ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи!