# ржЕржбрж┐ржУ ржбрж╛ржЯрж╛рж╕рзЗржЯржХрзЗ рж▓рзЛржб ржПржмржВ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рж╛

ржПржЗ ржХрзЛрж░рзНрж╕рзЗ ржЖржорж░рж╛ ржЕржбрж┐ржУ ржбрзЗржЯрж╛рж╕рзЗржЯрзЗрж░ рж╕рж╛ржерзЗ ржХрж╛ржЬ ржХрж░рж╛рж░ ржЬржирзНржп ЁЯдЧ ржбрзЗржЯрж╛рж╕рзЗржЯ рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмред ЁЯдЧ ржбрзЗржЯрж╛рж╕рзЗржЯ рж╣рж▓ ржПржХржЯрж┐ ржУржкрзЗржи рж╕рзЛрж░рзНрж╕ рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ ржпрж╛рждрзЗ ржЕржбрж┐ржУ рж╕рж╣ рж╕ржорж╕рзНржд
ржкржжрзНржзрждрж┐ ржерзЗржХрзЗ ржбрзЗржЯрж╛рж╕рзЗржЯ ржбрж╛ржЙржирж▓рзЛржб ржПржмржВ ржкрзНрж░рж╕рзНрждрзБржд ржХрж░рж╛ ржпрж╛рзЯред Hugging Face Hub-ржП рж╕рж░рзНржмржЬржирзАржиржнрж╛ржмрзЗ ржЙржкрж▓ржмрзНржз ржорзЗрж╢рж┐ржи рж▓рж╛рж░рзНржирж┐ржВ ржбрзЗржЯрж╛рж╕рзЗржЯрзЗрж░ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рж╛рж░ ржЬржирзНржпрзЗ ЁЯдЧ ржбрзЗржЯрж╛рж╕рзЗржЯ ржПржХржЯрж┐ ржЕрждрзБрж▓ржирзАржпрж╝ рж╕рж╣ржЬ ржЙржкрж╛рзЯред
рждрж╛ржЫрж╛ржбрж╝рж╛, ЁЯдЧ ржбрзЗржЯрж╛рж╕рзЗржЯ ржЧржмрзЗрж╖ржХ ржПржмржВ ржЕржирзБрж╢рзАрж▓ржиржХрж╛рж░рзА ржЙржнржпрж╝рзЗрж░ ржЬржирзНржп ржПржЗ ржзрж░ржирзЗрж░ ржбрзЗржЯрж╛рж╕рзЗржЯрзЗрж░ рж╕рж╛ржерзЗ ржХрж╛ржЬ ржХрж░рж╛ рж╕рж╣ржЬ ржХрж░рзЗред

ржЕржбрж┐ржУ ржбрзЗржЯрж╛рж╕рзЗржЯржЧрзБрж▓рж┐рж░ рж╕рж╛ржерзЗ ржХрж╛ржЬ рж╢рзБрж░рзБ ржХрж░рждрзЗ, ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзБржи ржпрзЗ ржЖржкржирж╛рж░ ржХрж╛ржЫрзЗ ЁЯдЧ ржбрзЗржЯрж╛рж╕рзЗржЯ рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ ржЗржирж╕рзНржЯрж▓ ржХрж░рж╛ ржЖржЫрзЗ:

```bash
pip install datasets[audio]
```

ЁЯдЧ ржбрзЗржЯрж╛рж╕рзЗржЯрзЗрж░ ржорзВрж▓ ржмрзИрж╢рж┐рж╖рзНржЯрзНржпржЧрзБрж▓рж┐рж░ ржоржзрзНржпрзЗ ржПржХржЯрж┐ рж╣рж▓ `load_dataset()` ржлрж╛ржВрж╢ржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ рж╢рзБржзрзБржорж╛рждрзНрж░ ржПржХржЯрж┐ рж▓рж╛ржЗржирзЗ ржПржХржЯрж┐ ржбрзЗржЯрж╛рж╕рзЗржЯ ржбрж╛ржЙржирж▓рзЛржб ржПржмржВ ржкрзНрж░рж╕рзНрждрзБржд ржХрж░рж╛рж░ ржХрзНрж╖ржорждрж╛ред

ржЖрж╕рзБржи [MINDS-14](https://huggingface.co/datasets/PolyAI/minds14) ржирж╛ржоржХ ржЕржбрж┐ржУ ржбрзЗржЯрж╛рж╕рзЗржЯ рж▓рзЛржб ржПржмржВ ржЕржирзНржмрзЗрж╖ржг ржХрж░рж┐, ржпрж╛рж░ ржоржзрзНржпрзЗ рж░ржпрж╝рзЗржЫрзЗ ржмрж┐ржнрж┐ржирзНржи ржнрж╛рж╖рж╛
ржПржмржВ ржЙржкржнрж╛рж╖рж╛ржпрж╝ ржПржХржЯрж┐ ржЗ-ржмрзНржпрж╛ржВржХрж┐ржВ рж╕рж┐рж╕рзНржЯрзЗржорзЗрж░ ржкрзНрж░рж╢рзНржи ржЬрж┐ржЬрзНржЮрж╛рж╕рж╛ ржХрж░рж╛ рж▓рзЛржХрзЗржжрзЗрж░ рж░рзЗржХрж░рзНржбрж┐ржВред

MINDS-14 ржбрзЗржЯрж╛рж╕рзЗржЯ рж▓рзЛржб ржХрж░рж╛рж░ ржЬржирзНржп, ржЖржорж╛ржжрзЗрж░ рж╣рж╛ржмрзЗ (`PolyAI/minds14`) ржбрзЗржЯрж╛рж╕рзЗржЯрзЗрж░ рж╢ржирж╛ржХрзНрждржХрж╛рж░рзА ржХржкрж┐ ржХрж░рзЗ ржкрж╛рж╕ ржХрж░рждрзЗ рж╣ржмрзЗ `рж▓рзЛржб_ржбрзЗржЯрж╛рж╕рзЗржЯ` ржлрж╛ржВрж╢ржирзЗред ржЖржорж░рж╛
ржПржЯрж╛ржУ ржЙрж▓рзНрж▓рзЗржЦ ржХрж░ржм ржпрзЗ ржЖржорж░рж╛ рж╢рзБржзрзБржорж╛рждрзНрж░ ржЕрж╕рзНржЯрзНрж░рзЗрж▓рж┐ржпрж╝рж╛ржи рж╕рж╛ржмрж╕рзЗржЯрзЗ (`en-AU`) ржЖржЧрзНрж░рж╣рзА, ржПржмржВ train ржмрж┐ржнрж╛ржЬржирзЗ рж╕рзАржорж╛ржмржжрзНржз ржХрж░рзБржи:


```py
from datasets import load_dataset

minds = load_dataset("PolyAI/minds14", name="en-AU", split="train")
minds
```

**ржЖржЙржЯржкрзБржЯ:**
```out
Dataset(
    {
        features: [
            "path",
            "audio",
            "transcription",
            "english_transcription",
            "intent_class",
            "lang_id",
        ],
        num_rows: 654,
    }
)
```

ржбрзЗржЯрж╛рж╕рзЗржЯрзЗ рзмрзлрзк ржЯрж┐ ржЕржбрж┐ржУ ржлрж╛ржЗрж▓ рж░ржпрж╝рзЗржЫрзЗ, ржпрж╛рж░ ржкрзНрж░рждрж┐ржЯрж┐рж░ рж╕рж╛ржерзЗ ржПржХржЯрж┐ ржЯрзНрж░рж╛ржирзНрж╕ржХрзНрж░рж┐ржкрж╢ржи, ржПржХржЯрж┐ ржЗржВрж░рзЗржЬрж┐ ржЕржирзБржмрж╛ржж ржПржмржВ ржПржХржЯрж┐ рж▓рзЗржмрзЗрж▓ рж░ржпрж╝рзЗржЫрзЗ
ржмрзНржпржХрзНрждрж┐рж░ ржкрзНрж░рж╢рзНржирзЗрж░ ржкрж┐ржЫржирзЗ ржЕржнрж┐ржкрзНрж░рж╛ржпрж╝ ржЗржЩрзНржЧрж┐ржд. ржЕржбрж┐ржУ ржХрж▓рж╛ржорзЗ ржХрж╛ржБржЪрж╛ ржЕржбрж┐ржУ ржбрзЗржЯрж╛ ржерж╛ржХрзЗред ржПрж░ ржПржХржЯрж┐ ржШржирж┐рж╖рзНржаржнрж╛ржмрзЗ ржХржЯрж╛ржХрзНрж╖ржкрж╛ржд ржХрж░рж╛ ржпрж╛ржХ
ржЙржжрж╛рж╣рж░ржгржЧрзБрж▓рж┐рж░ ржПржХржЯрж┐рждрзЗ:

```py
example = minds[0]
example
```

**ржЖржЙржЯржкрзБржЯ:**
```out
{
    "path": "/root/.cache/huggingface/datasets/downloads/extracted/f14948e0e84be638dd7943ac36518a4cf3324e8b7aa331c5ab11541518e9368c/en-AU~PAY_BILL/response_4.wav",
    "audio": {
        "path": "/root/.cache/huggingface/datasets/downloads/extracted/f14948e0e84be638dd7943ac36518a4cf3324e8b7aa331c5ab11541518e9368c/en-AU~PAY_BILL/response_4.wav",
        "array": array(
            [0.0, 0.00024414, -0.00024414, ..., -0.00024414, 0.00024414, 0.0012207],
            dtype=float32,
        ),
        "sampling_rate": 8000,
    },
    "transcription": "I would like to pay my electricity bill using my card can you please assist",
    "english_transcription": "I would like to pay my electricity bill using my card can you please assist",
    "intent_class": 13,
    "lang_id": 2,
}
```

ржЖржкржирж┐ рж▓ржХрзНрж╖рзНржп ржХрж░рждрзЗ ржкрж╛рж░рзЗржи ржпрзЗ ржЕржбрж┐ржУ ржХрж▓рж╛ржорзЗ ржмрзЗрж╢ ржХржпрж╝рзЗржХржЯрж┐ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп рж░ржпрж╝рзЗржЫрзЗред ржПржЦрж╛ржирзЗ рждрж╛рж░рж╛ ржХрж┐:
* `path`: ржЕржбрж┐ржУ ржлрж╛ржЗрж▓рзЗрж░ ржкрже (ржПржЗ ржХрзНрж╖рзЗрждрзНрж░рзЗ `*.wav`)ред
* `array`: ржбрж┐ржХрзЛржб ржХрж░рж╛ ржЕржбрж┐ржУ ржбрзЗржЯрж╛, ржПржХржЯрж┐ 1-ржорж╛рждрзНрж░рж┐ржХ NumPy ржЕрзНржпрж╛рж░рзЗ рж╣рж┐рж╕рж╛ржмрзЗ ржЙржкрж╕рзНржерж╛ржкрж┐рждред
* `sampling_rate`ред ржЕржбрж┐ржУ ржлрж╛ржЗрж▓рзЗрж░ sampling_rate (ржПржЗ ржЙржжрж╛рж╣рж░ржгрзЗ рзо,рзжрзжрзж Hz)ред

'intent_class' рж╣рж▓ ржЕржбрж┐ржУ рж░рзЗржХрж░рзНржбрж┐ржВржпрж╝рзЗрж░ ржПржХржЯрж┐ рж╢рзНрж░рзЗржгрзАржмрж┐ржнрж╛ржЧред ржПржЗ рж╕ржВржЦрзНржпрж╛ржЯрж┐ржХрзЗ ржПржХржЯрж┐ ржЕрж░рзНржержкрзВрж░рзНржг рж╕рзНржЯрзНрж░рж┐ржВржпрж╝рзЗ рж░рзВржкрж╛ржирзНрждрж░ ржХрж░рждрзЗ,
ржЖржорж░рж╛ `int2str()` ржкржжрзНржзрждрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рж┐:

```py
id2label = minds.features["intent_class"].int2str
id2label(example["intent_class"])
```

**ржЖржЙржЯржкрзБржЯ:**
```out
"pay_bill"
```

ржЖржкржирж┐ ржпржжрж┐ ржЯрзНрж░рж╛ржирзНрж╕ржХрзНрж░рж┐ржкрж╢ржи ржмрзИрж╢рж┐рж╖рзНржЯрзНржпржЯрж┐ ржжрзЗржЦрзЗржи рждржмрзЗ ржЖржкржирж┐ ржжрзЗржЦрждрзЗ ржкрж╛ржмрзЗржи ржпрзЗ ржЕржбрж┐ржУ ржлрж╛ржЗрж▓ржЯрж┐ ржкрзНрж░ржХрзГрждржкржХрзНрж╖рзЗ ржПржХржЬржи ржмрзНржпржХрзНрждрж┐ржХрзЗ ржПржХржЯрж┐ ржкрзНрж░рж╢рзНржи ржЬрж┐ржЬрзНржЮрж╛рж╕рж╛ ржХрж░рзЗ рж░рзЗржХрж░рзНржб ржХрж░рзЗржЫрзЗ
ржмрж┐рж▓ ржкрж░рж┐рж╢рзЛржз рж╕ржорзНржкрж░рзНржХрзЗред

ржЖржкржирж┐ ржпржжрж┐ ржбрзЗржЯрж╛рж░ ржПржЗ ржЙржкрж╕рзЗржЯрзЗ ржПржХржЯрж┐ audio classifier ржХрзЗ train ржХрж░рж╛рж░ ржкрж░рж┐ржХрж▓рзНржкржирж╛ ржХрж░рзЗржи, рждрж╛рж╣рж▓рзЗ ржЖржкржирж╛рж░ рж╕ржорж╕рзНржд ржмрзИрж╢рж┐рж╖рзНржЯрзНржпрзЗрж░ ржкрзНрж░ржпрж╝рзЛржЬржи ржирж╛ржУ рж╣рждрзЗ ржкрж╛рж░рзЗред ржЙржжрж╛рж╣рж░ржг рж╕рзНржмрж░рзВржк,
рж╕ржм ржЙржжрж╛рж╣рж░ржгрзЗрж░ ржЬржирзНржп `lang_id`-ржПрж░ ржорж╛ржи ржПржХржЗ рж╣ржмрзЗ ржПржмржВ ржХрж╛ржЬрзЗ рж▓рж╛ржЧржмрзЗ ржирж╛ред `english_transcription` рж╕ржорзНржнржмржд рж╣ржмрзЗ
ржПржЗ ржЙржкрж╕рзЗржЯрзЗ `transcription` ржиржХрж▓ ржХрж░рзБржи, ржпрж╛рждрзЗ ржЖржорж░рж╛ ржирж┐рж░рж╛ржкржжрзЗ рж╕рзЗржЧрзБрж▓рж┐ рж╕рж░рж╛рждрзЗ ржкрж╛рж░рж┐ред

ржЖржкржирж┐ ЁЯдЧ ржбрзЗржЯрж╛рж╕рзЗржЯржЧрзБрж▓рж┐рж░ `remove_columns` ржкржжрзНржзрждрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ рж╕рж╣ржЬрзЗржЗ ржЕржкрзНрж░рж╛рж╕ржЩрзНржЧрж┐ржХ ржмрзИрж╢рж┐рж╖рзНржЯрзНржпржЧрзБрж▓рж┐ рж╕рж░рж╛рждрзЗ ржкрж╛рж░рзЗржи:

```py
columns_to_remove = ["lang_id", "english_transcription"]
minds = minds.remove_columns(columns_to_remove)
minds
```

**ржЖржЙржЯржкрзБржЯ:**
```out
Dataset({features: ["path", "audio", "transcription", "intent_class"], num_rows: 654})
```

ржПржЦржи ржпрзЗрж╣рзЗрждрзБ ржЖржорж░рж╛ ржбрзЗржЯрж╛рж╕рзЗржЯрзЗрж░ ржХрж╛ржБржЪрж╛ ржмрж┐рж╖ржпрж╝ржмрж╕рзНрждрзБ рж▓рзЛржб ржПржмржВ ржкрж░рж┐ржжрж░рзНрж╢ржи ржХрж░рзЗржЫрж┐, ржЖрж╕рзБржи ржХржпрж╝рзЗржХржЯрж┐ ржЙржжрж╛рж╣рж░ржг рж╢рзБржирж┐! ржЖржорж░рж╛ 'Gradio' ржерзЗржХрзЗ 'Blocks' ржПржмржВ 'Audio' ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржм
ржбрзЗржЯрж╛рж╕рзЗржЯ ржерзЗржХрзЗ ржХржпрж╝рзЗржХржЯрж┐ ржиржорзБржирж╛ ржбрж┐ржХрзЛржб ржХрж░рждрзЗред

```py
import gradio as gr


def generate_audio():
    example = minds.shuffle()[0]
    audio = example["audio"]
    return (
        audio["sampling_rate"],
        audio["array"],
    ), id2label(example["intent_class"])


with gr.Blocks() as demo:
    with gr.Column():
        for _ in range(4):
            audio, label = generate_audio()
            output = gr.Audio(audio, label=label)

demo.launch(debug=True)
```

ржЖржкржирж┐ ржпржжрж┐ ржЪрж╛ржи, ржЖржкржирж┐ ржХрж┐ржЫрзБ ржЙржжрж╛рж╣рж░ржгржУ ржкрж░рзНржпржмрзЗржХрзНрж╖ржг ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред ржкрзНрж░ржержо ржЙржжрж╛рж╣рж░ржгрзЗрж░ рждрж░ржЩрзНржЧрж░рзВржк ржкрзНрж▓ржЯ ржХрж░рж╛ ржпрж╛ржХред

```py
import librosa
import matplotlib.pyplot as plt
import librosa.display

array = example["audio"]["array"]
sampling_rate = example["audio"]["sampling_rate"]

plt.figure().set_figwidth(12)
librosa.display.waveshow(array, sr=sampling_rate)
```

<div class="flex justify-center">
    <img src="https://huggingface.co/datasets/huggingface-course/audio-course-images/resolve/main/waveform_unit1.png" alt="Waveform plot">
</div>

ржПржЦржи ржирж┐ржЬрзЗ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржи! MINDS-14 ржбрзЗржЯрж╛рж╕рзЗржЯрзЗрж░ ржЕржирзНржп ржПржХржЯрж┐ ржЙржкржнрж╛рж╖рж╛ ржмрж╛ ржнрж╛рж╖рж╛ ржбрж╛ржЙржирж▓рзЛржб ржХрж░рзБржи, ржЙржкрж▓ржмрзНржзрж┐ ржХрж░рждрзЗ ржХрж┐ржЫрзБ ржЙржжрж╛рж╣рж░ржг рж╢рзБржирзБржи ржПржмржВ ржкрж░рзНржпржмрзЗржХрзНрж╖ржг ржХрж░рзБржиред ржЖржкржирж┐
[ржПржЦрж╛ржирзЗ] (https://huggingface.co/datasets/PolyAI/minds14) ржЙржкрж▓ржмрзНржз ржнрж╛рж╖рж╛рж░ рж╕ржорзНржкрзВрж░рзНржг рждрж╛рж▓рж┐ржХрж╛ ржкрзЗрждрзЗ ржкрж╛рж░рзЗржиред
